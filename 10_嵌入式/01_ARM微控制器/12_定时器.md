# 定时器
定时器又叫做计算器，是各种微控制器都有的一个功能，大量的程序的实现都需要定时器
- 依赖于时钟来完成定时和计数
- 时钟信号可以是CPU内部的系统时钟，也可能是由外部的时钟
- 常用的定时器是8位，16位和32位的

------
## 用途
- 定时中断的产生
- 产生特定的延时，或者测量延时
- 周期和脉宽的测量
- 频率的测量
- 外部事件计数
- 波形调制输出
**因为有了个定时器，我们可以相对于主程序独立的，准确定时去执行一段程序**

------
## 工作模式
- 开始的时候可能是freerun的一种自由运行的模式，总是从0到最大值，然后溢出，周而复始的运算
- 通常使用的是modulated的计数器，一般可以人工的设置一个预设值，预设值每次递减为0，就完成了一个计时，然后再归为预设值
- 在一个时钟基础上数任意多个数完成所需要的周期
- 误差取决于计数器的时钟频率和时钟源是否稳定


------
## SysTick-系统节拍
- 它是由ARM公司设定的一个基本的功能单元，基本外设
- 一个简单的24位宽的，带有调制的计数定时器
- 时钟源可以是系统时钟源，也可以是指定的系统时钟源的分频
- 它可以产生中断，只需要3到4个寄存器就可以使用起来
> CSR寄存器，清零是读清
> 从系统上电开始，默认的时钟树，通过片内的振荡器和锁频环，锁相环，最后会翻到系统的时钟20.97Mhz

------
## 编程
1. 把中断的开关打开
> 总开关打开，子开关打开，**0-15是arm公司预留的16个异常中断向量**
2. 配置中断源，多长时间中断一次
3. 编写ISR函数
> 中断服务程序是设置条件每当发生的时候，硬件自动通知的CPU，由CPU自动调用的函数
> 函数中，执行时间，**最后要清中断标志位**
4. 把ISR函数放到中断向量表中