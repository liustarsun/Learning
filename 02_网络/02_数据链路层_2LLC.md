数据链路层为什么要分层？

这个问题和前面讲到的有很大关系：（1）半双工模式下采用的是CSMA/CD的访问方式（2）全双工模式下则可直接收发，不管线路的忙闲状态。半双工和全双工是物理层的概念，而针对物理层的双工模式提供不同的访问方式则是数据链路层的概念，因此：数据链路层和物理层是相关的。为了针对物理层的不同工作模式进行访问，后来提出了逻辑链路控制子层（LLC）和媒体访问控制子层(MAC)。这样：不同的物理层对应不同的MAC子层，LLC子层则完全独立。
数据链路层中与接入各种传输媒体有关的内容放在MAC子层，其主要内容有：数据帧的封装和拆卸、实现和维护MAC协议、比特差错控制以及寻址。
数据链路层中与接入各种传输媒体无关的内容放在LLC子层，其主要内容有：建立和释放数据链路层的逻辑连接、提供与高层的接口以及差错控制。 
MAC子层及其功能：

功能有三：（1）提供物理链路的访问：即是连接下层，访问物理层可以通过MAC子层。（2）链路级的站点标识，即是在该层次保留了MAC地址标识一个唯一 的站点。（3）链路级的数据传输：即是连接LLC子层，从LLC子层接受数据，附加上MAC地址和控制信息后再校验一下放到物理层去。总结：MAC子层就是承上启下，加MAC地址。

什么是MAC地址？

MAC地址是IEEE管理，一个制造商从IEEE获得唯一的地址块，这个获得的地址块又被称为一个组织的OUI（Organizationally Unique Identifier）,获得这个地址可以为16777216个设备分配地址。

MAC地址后48bit,通常被表示为12bit的点分十六进制数。前六位代表某个制造商，后六位由制造商自己决定。

假设分给思科某个设备为00-60-2F-1A-2E-3D，那么00-60-2F是思科OUI。后面六位则是思科内部给设备分的地址。

MAC地址分类：（1）物理MAC地址：固化在硬件里（如网卡）中，网络上绝对唯一的标识一个终端。（2）广播MAC地址：其48bit全部位1，如FF-FF-FF-FF-FF-FF，代表网络上的所有终端设备。（3）组播MAC地址：一个逻辑MAC地址，代表网络上的一组终端（这个以后会提到）。

LLC子层及其功能：

LLC负责识别网络层协议，然后对它们进行封装。LLC报头告诉数据链路层一旦帧被接收到时，应当对数据包做何处理。工作原理：主机接收到帧并查看其 LLC报头，以找到数据包的目的地；LLC子层也可以提供流量控制并控制比特流的排序。总结：LLC子层也是一个承上启下的作用，连接网络层和MAC子 层。

它定义三种数据操作类型：（1）无连接，这种传输效果难以保证。（2）面向连接，该方式提供了四种服务：连接的建立、确认和数据到达响应、差错恢复（请求重发接收的错误数据）以及滑动窗口（用来提高数据传输速率）。（3）无连接应答响应服务。

总结：MAC子层和LLC子层都是起到承上启下的作用，MAC子层和LLC子层的作用在以后的具体帧格式中还会提到，其中MAC地址是本节最重要的概念。

在常见的IEEE 802系列标准中，将数据链路层分为两个部分：（1）逻辑链接控制（Logical Link Control，LLC）子层；（2）媒体访问控制（Medium Access Control，MAC）子层。其中MAC子层是制定如何使用传输媒体的通信协议，如IEEE 802.3以太网标准的CSMA/CD协议中，MAC子层规定如何在总线型网络结构下使用传输媒体；IEEE 802.4令牌总线（Token-Bus）标准中，MAC子层规定了如何在总线的网络结构下利用讯标（Token）控制传输媒体的使用；IEEE 802.5令牌环（Token-Ring）标准中，MAC子层规定了如何在环状网络结构下利用讯标来控制传输媒体的使用；IEEE 802.11无线局域网标准中，MAC子层规定如何在无线局域网络的结构下控制传输媒体的使用。
LLC子层的主要工作是控制信号交换、数据流量控制（Data Flow Control），解释上层通信协议传来的命令并且产生响应，以及克服数据在传送的过程中所可能发生的种种问题（如数据发生错误，重复收到相同的数据，接收数据的顺序与传送的顺序不符等）。在LLC子层方面，IEEE 802系列标准中只制定了一种标准，各种不同的MAC都使用相同的LLC子层通信标准，使更高层的通信协议可不依赖局域网络的实际架构。
不同工作站的网络层通信协议可通过LLC子层来沟通。由于网络层上可能有许多种通信协议同时存在，而且每一种通信协议又可能同时与多个对象沟通，因此当LLC子层从MAC子层收到一个数据包时必须能够判断要送给网络层的哪一个通信协议。为了达到这种功能，LLC子层提供了所谓的“服务点”（Service Access Point，SAP）服务，通过它可以简化数据转送的处理过程。为了能够辨认出LLC子层通信协议间传送的数据属于谁，每一个LLC数据单元（LLC Data Unit）上都有“目的地服务点”（Destination Service Access Point, DSAP） 和“原始服务点”（Source Service Access Point，SSAP）。一对DSAP与SSAP即可形成通信连接。由SSAP送出来的数据经过LLC子层的传送之后便送给DSAP，反之亦然。因此DSAP与SSAP成为独立的联机通信，彼此间所传送的数据不会与其他联机通信的数据交换。当然在传送的过程中所有联机通信的数据都必须经由惟一的MAC管道来传送。


2.为何只有局域网内链路层分成两个子层？
   802.3（局域网）是共享介质的，而广域网是专用的（通常是点对点的）不存在介质冲突的问题

局域网的数据链路层：
局域网最大特点是网络为一个单位所拥有，且地里范围和站点数目均有限。 
为了使数据链路层能更好地适应多种局域网标准，IEEE 802委员会就把局域网的数据链路层拆成两个子层，即逻辑链路层LLC子层和媒体接入控制MAC（MAC地址）子层。与接入到传输媒体有关的内容都放在MAC子层，而LLC子层则与传输媒体无关，不管采用何种传输媒体和MAC子层的局域网对LLC子层来说都是透明的。
[转载]数据链路层的分层MAC-LLC

以太网在局域网中已取得垄断的地位，并且几乎成为了局域网的代名词。由于因特网发展很快，现在逻辑链路控制子层LLC的作用已经消失了，很多厂商生产网卡适配器就仅装有MAC协议而没有LLC协议。
（局域网分类：以太网，ATM，令牌网，WLAN）LLC则是对于不同局域网介质的处理的层次，因为现在都是以太网了，所以LLC层逐步退出
分享： 


1.为何只有局域网内链路层分成两个子层？
   802.3（局域网）是共享介质的，而广域网是专用的（通常是点对点的）不存在介质冲突的问题


2.何为数据链路层的（DATA LINK LAYER）的MAC子层和LLC子层？
   MAC子层的主要功能包括数据帧的封装/卸装，帧的寻址和识别，帧的接收与发送，链路的管理，帧的差错控制等。MAC子层的存在屏蔽了不同物理链路种类的差异性;


   在MAC子层的诸多功能中，非常重要的一项功能是仲裁介质的使用权，即规定站点何时可以使用通信介质。实际上，局域网技术中是采用具有冲突检测的载波侦听多路访问（Carrier Sense Multiple Access /
Collision Detection，CSMA/CD）这种介质访问方法的。
 
   LLC子层负责向其上层提供服务；
LLC 是在高级数据链路控制（HDLC：High-Level Data-Link Control）的基础上发展起来的，并使用了 HDLC 规范子集。LLC 定义了三种数据通信操作类型：


类型1：无连接。该方式对信息的发送通常无法保证接收。
类型2：面向连接。该方式提供了四种服务：连接的建立、确认和承认响应、差错恢复（通过请求重发接收到的错误数据实现）以及滑动窗口（系数：128）。通过改变滑动窗口可以提高数据传输速率。
类型3：无连接承认响应服务。
类型1的 LLC 无连接服务中规定了一种静态帧格式，并支持运行网络协议。有关传输层网络协议通常是使用服务类型1方式。
注意：在Windows 2000网络体系结构中，LLC子层是由传输驱动程序实现的，而MAC子层是由网络接口卡（NIC:网卡）来实现。
类型2的 LLC 面向连接服务支持可靠数据传输，运用于不需要调用网络层和传输层协议的局域网环境。



LLC子层
LLC-Logical Link Control 逻辑链路控制
　　LLC是Logic Link Control的缩写，意为：逻辑链路控制。
　　IEEE于1980年2月成立了局域网标准委员会（简称IEEE802委员会），专门从事局域网标准化工作，并制定了IEEE802标准。802标准所描述的局域网参考模型只对应OSI参考模型的数据链路层与物理层，它将数据链路层划分为逻辑链路层LLC子层和介质访问控制MAC子层.IEEE802委员会为局域网制订了一系列标准，统称为802标准。其中 IEEE 802.2 LAN 标准定义了逻辑链路控制LLC子层的功能与服务，并且是IEEE 802.3，IEEE 802.4和 IEEE 802.5等标准的基标准。
　　LLC负责识别网络层协议，然后对它们进行封装。LLC报头告诉数据链路层一旦帧被接收到时，应当对数据包做何处理。它的工作原理是这样的：
主机接收到帧并查看其LLC报头，以找到数据包的目的地，比如说，在网际层的IP协议。LLC子层也可以提供流量控制并控制比特流的排序。


　　 IEEE 802.2 LLC 应用于 IEEE802.3 （以太网）和 IEEE802.5（令牌环） LAN，以实现如下功能：
　　1.管理数据链路通信 
　　2.链接寻址 
　　3.定义服务接入点 Service Access Points （SAP） 
　　4.排序 
　　LLC 为上层提供了处理任何类型 MAC 层的方法，例如，以太网 IEEE 802.3 CSMA/CD 或者令牌环 IEEE 802.5 令牌传递（Token Passing）方式。
　　LLC 是在高级数据链路控制（HDLC ： High-Level Data-Link Control）的基础上发展起来的，并使用了 HDLC 规范的子集。LLC 定义了三种数
据通信操作类型：
　　类型1：无连接。该方式不保证发送的信息一定可以收到。
　　类型2：面向连接。该方式提供了四种服务：连接的建立、确认和数据到达响应、差错恢复（通过请求重发接收到的错误数据实现）以及滑动窗口
（系数：128）。滑动窗口用来提高数据传输速率。
　　类型3：无连接应答响应服务。
　　类型1的 LLC 无连接服务中规定了一种静态帧格式，并允许在其上运行网络协议。使用传输层协议的网络协议通常会使用服务类型1方式。
　　类型2的 LLC 面向连接服务支持可靠数据传输，运用于不需要调用网络层和传输层协议的局域网环境 。


——————————————————————————————————————————————


介质访问控制（MAC子层）


　　介质访问控制是 解决当局域网中共用信道的使用产生竞争时，如何分配信道的使用权问题.
　　逻辑链路 Logical Links 是实际电路或逻辑电路上交换通信信息的两个端系统之间的一种协议驱动通信会话。协议栈定义了两个系统在某种介质上的通信。在协议栈低层定义可用的多种不同类型的通信协议，如局域网络(LAN)、城域网(MAN)和象X．25或帧中继这样的分组交换网络。逻辑链路在物理链路(可以是铜线、光纤或其他介质)上的两个通信系统之间形成。根据OSI协议模型，这些逻辑链路只在物理层以上存在。你可以认为逻辑链路是存在于网络两个末断系统间的线路。　
　　面向连接的服务 为了保证可靠的通信，需要建立逻辑线路，但在两个端系统间要维持会话。　
　　面向需要应答连接的服务 分组传输并有返回信号的逻辑线路。这种服务产生更大的开销，但更加可靠。　
　　无应答不连接服务 无需应答和预先的传送。在端系统间没有会话。　
　　OSI协议栈中的数据链路层可进一步细分为较低的介质访问控制(MAC)子层和较高的逻辑链路控制(LLC)子层。当它接收到一个分组后，它从MAC子层向上传送。如果有多个网络和设备相连，LLC层可能将分组送给另一个网络。例如，在一个NetWare服务器上，你可能既安装了以太网络适配器又安装了令牌网络适配器，NetWare自动地在连接到适配器的网络间桥接，这样原来在以太网上的分组就可以传送到令牌网上的目的地了，LLC层就象网络段间的交换或链路中继，它将以太网的帧重装成令牌环网的帧。　


———————————————————————————————————————————————


MAC子层与LLC子层的不同之处：


　MAC（Media Access Control，媒体访问控制）子层定义了数据包怎样在介质上进行传输。在共享同一个带宽的链路中，对连接介质的访问是“先来先服务”的。物理寻址在此处被定义，逻辑拓扑（信号通过物理拓扑的路径）也在此处被定义。线路控制、出错通知（不纠正）、帧的传递顺序和可选择的流量控制也在这一子层实现。 
　　注解：该协议位于OSI七层协议中数据链路层，数据链路层分为上层LLC（逻辑链路控制），和下层的MAC（媒体访问控制），MAC主要负责控制与连接物理层的物理介质。在发送数据的时候，MAC协议可以事先判断是否可以发送数据，如果可以发送将给数据加上一些控制信息，最终将数据以及控制信息以规定的格式发送到物理层；在接收数据的时候，MAC协议首先判断输入的信息并是否发生传输错误，如果没有错误，则去掉控制信息发送至LLC（逻辑链路控制）层。 
　　应用：不管是在传统的有线局域网（LAN）中还是在目前流行的无线局域网（WLAN）中，MAC协议都被广泛地应用。在传统局域网中，各种传输介质（铜缆、光线等）的物理层对应到相应的MAC层，目前普遍使用的网络采用的是IEEE 802.3的MAC层标准，采用CSMA/CD访问控制方式；而在无线局域网中，MAC所对应的标准为IEEE 802.11，其工作方式采用DCF（分布控制）和PCF（中心控制）。 
　　 
　　逻辑链路（Logical Links）是实际电路或逻辑电路上交换通信信息的两个端系统之间的一种协议驱动通信会话。协议栈定义了两个系统在某种介质上的通信。在协议栈低层定义可用的多种不同类型的通信协议，如局域网络(LAN)、城域网(MAN)和象X．25或帧中继这样的分组交换网络。逻辑链路在物理链路(可以是铜线、光纤或其他介质)上的两个通信系统之间形成。根据OSI协议模型，这些逻辑链路只在物理层以上存在。你可以认为逻辑链路是存在于网络两个末断系统间的线路。


LLC子层负责向其上层提供服务；

LLC子层的主要功能包括： 
* 传输可靠性保障和控制； 
* 数据包的分段与重组； 
* 数据包的顺序传输。
MAC子层的主要功能包括数据帧的封装/卸装，帧的寻址和识别，帧的接收与发送，链路的管理，帧的差错控制等。MAC子层的存在屏蔽了不同物理链路种类的差异性。